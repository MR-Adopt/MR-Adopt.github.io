JUnit version 4.13.2
SLF4J(W): Class path contains multiple SLF4J providers.
SLF4J(W): Found provider [org.mule.slf4j.impl.StaticLoggerBinder@612531a3]
SLF4J(W): Found provider [org.apache.logging.slf4j.SLF4JServiceProvider@3a83cfbc]
SLF4J(W): Found provider [com.github.valfirst.slf4jtest.TestSLF4JServiceProvider@6b9fc5c7]
SLF4J(W): See https://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J(I): Actual provider is of type [org.mule.slf4j.impl.StaticLoggerBinder@612531a3]
.
================================================================================
= Testing: returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5      =
================================================================================

Time: 6.059

OK (1 test)

CMD: cd /ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ ; /ssddata1/cxubl/software/zulu_jdks/zulu11.62.17-ca-jdk11.0.18-linux_x64/bin/java -XX:ActiveProcessorCount=10 -classpath ./:./core-tests/target/test-classes:./core-tests/target/dependency/*:./core-tests/target/classes:./core/target/classes:./core/target/dependency/*:./core/target/test-classes:./modules/all-modules/target/dependency/*:./modules/artifact-activation/target/classes:./modules/artifact-activation/target/test-classes:./modules/artifact-activation/target/dependency/*:./modules/artifact/target/classes:./modules/artifact/target/test-classes:./modules/artifact/target/dependency/*:./modules/boot-api/target/classes:./modules/boot-api/target/test-classes:./modules/boot-api/target/dependency/*:./modules/container/target/classes:./modules/container/target/test-classes:./modules/container/target/dependency/*:./modules/core-components/target/classes:./modules/core-components/target/test-classes:./modules/core-components/target/dependency/*:./modules/deployment-model-impl/target/classes:./modules/deployment-model-impl/target/test-classes:./modules/deployment-model-impl/target/dependency/*:./modules/deployment-model/target/classes:./modules/deployment-model/target/test-classes:./modules/deployment-model/target/dependency/*:./modules/deployment/target/classes:./modules/deployment/target/test-classes:./modules/deployment/target/dependency/*:./modules/extensions-mule-support/target/classes:./modules/extensions-mule-support/target/test-classes:./modules/extensions-mule-support/target/dependency/*:./modules/extensions-soap-support/target/classes:./modules/extensions-soap-support/target/test-classes:./modules/extensions-soap-support/target/dependency/*:./modules/extensions-spring-support/target/classes:./modules/extensions-spring-support/target/test-classes:./modules/extensions-spring-support/target/dependency/*:./modules/extensions-support/target/classes:./modules/extensions-support/target/test-classes:./modules/extensions-support/target/dependency/*:./modules/extensions-xml-support/target/classes:./modules/extensions-xml-support/target/test-classes:./modules/extensions-xml-support/target/dependency/*:./modules/feature-management/target/classes:./modules/feature-management/target/test-classes:./modules/feature-management/target/dependency/*:./modules/global-config/target/classes:./modules/global-config/target/test-classes:./modules/global-config/target/dependency/*:./modules/http-api/target/classes:./modules/http-api/target/test-classes:./modules/http-api/target/dependency/*:./modules/jar-handling-utils/target/classes:./modules/jar-handling-utils/target/dependency/*:./modules/jar-handling-utils/target/test-classes:./modules/javaee/target/classes:./modules/javaee/target/test-classes:./modules/javaee/target/dependency/*:./modules/jpms-utils/target/classes:./modules/jpms-utils/target/test-classes:./modules/jpms-utils/target/dependency/*:./modules/launcher/target/classes:./modules/launcher/target/test-classes:./modules/launcher/target/dependency/*:./modules/license-api/target/classes:./modules/license-api/target/test-classes:./modules/license-api/target/dependency/*:./modules/log4j-boot-configurator/target/classes:./modules/log4j-boot-configurator/target/test-classes:./modules/log4j-boot-configurator/target/dependency/*:./modules/log4j-configurator/target/classes:./modules/log4j-configurator/target/test-classes:./modules/log4j-configurator/target/dependency/*:./modules/logging/target/classes:./modules/logging/target/dependency/*:./modules/logging/target/test-classes:./modules/memory-management-parent/memory-management-tests/target/test-classes:./modules/memory-management-parent/memory-management-tests/target/dependency/*:./modules/memory-management-parent/memory-management-tests/target/classes:./modules/memory-management-parent/memory-management/target/classes:./modules/memory-management-parent/memory-management/target/dependency/*:./modules/memory-management-parent/memory-management/target/test-classes:./modules/metadata-support/target/classes:./modules/metadata-support/target/test-classes:./modules/metadata-support/target/dependency/*:./modules/metrics/mule-metrics-api/target/classes:./modules/metrics/mule-metrics-api/target/test-classes:./modules/metrics/mule-metrics-exporter-api/target/classes:./modules/metrics/mule-metrics-exporter-api/target/dependency/*:./modules/metrics/mule-metrics-exporter-api/target/test-classes:./modules/metrics/mule-metrics-exporter-configuration-api/target/classes:./modules/metrics/mule-metrics-exporter-configuration-api/target/test-classes:./modules/metrics/mule-metrics-exporter-configuration-impl/target/classes:./modules/metrics/mule-metrics-exporter-configuration-impl/target/test-classes:./modules/metrics/mule-metrics-exporter-configuration-impl/target/dependency/*:./modules/metrics/mule-metrics-exporter-impl/target/classes:./modules/metrics/mule-metrics-exporter-impl/target/test-classes:./modules/metrics/mule-metrics-exporter-impl/target/dependency/*:./modules/metrics/mule-metrics-impl/target/classes:./modules/metrics/mule-metrics-impl/target/test-classes:./modules/metrics/mule-metrics-impl/target/dependency/*:./modules/oauth-api/target/classes:./modules/oauth-api/target/dependency/*:./modules/oauth-api/target/test-classes:./modules/observability/target/classes:./modules/observability/target/dependency/*:./modules/observability/target/test-classes:./modules/properties-config/target/classes:./modules/properties-config/target/test-classes:./modules/properties-config/target/dependency/*:./modules/reboot/target/classes:./modules/reboot/target/dependency/*:./modules/reboot/target/test-classes:./modules/repository/target/classes:./modules/repository/target/test-classes:./modules/repository/target/dependency/*:./modules/service/target/classes:./modules/service/target/test-classes:./modules/service/target/dependency/*:./modules/soap-api/target/classes:./modules/soap-api/target/dependency/*:./modules/soap-api/target/test-classes:./modules/spring-config/target/classes:./modules/spring-config/target/test-classes:./modules/spring-config/target/dependency/*:./modules/tanuki-boot/target/classes:./modules/tanuki-boot/target/dependency/*:./modules/tanuki-boot/target/test-classes:./modules/tls/target/classes:./modules/tls/target/test-classes:./modules/tls/target/dependency/*:./modules/tooling-support/target/classes:./modules/tooling-support/target/test-classes:./modules/tooling-support/target/dependency/*:./modules/tracing/mule-tracer-api/target/classes:./modules/tracing/mule-tracer-api/target/dependency/*:./modules/tracing/mule-tracer-api/target/test-classes:./modules/tracing/mule-tracer-common/target/classes:./modules/tracing/mule-tracer-common/target/dependency/*:./modules/tracing/mule-tracer-common/target/test-classes:./modules/tracing/mule-tracer-configuration-api/target/classes:./modules/tracing/mule-tracer-configuration-api/target/test-classes:./modules/tracing/mule-tracer-configuration-impl/target/classes:./modules/tracing/mule-tracer-configuration-impl/target/test-classes:./modules/tracing/mule-tracer-configuration-impl/target/dependency/*:./modules/tracing/mule-tracer-customization-api/target/classes:./modules/tracing/mule-tracer-customization-api/target/dependency/*:./modules/tracing/mule-tracer-customization-api/target/test-classes:./modules/tracing/mule-tracer-customization-impl/target/classes:./modules/tracing/mule-tracer-customization-impl/target/test-classes:./modules/tracing/mule-tracer-customization-impl/target/dependency/*:./modules/tracing/mule-tracer-exporter-api/target/classes:./modules/tracing/mule-tracer-exporter-api/target/dependency/*:./modules/tracing/mule-tracer-exporter-api/target/test-classes:./modules/tracing/mule-tracer-exporter-configuration-api/target/classes:./modules/tracing/mule-tracer-exporter-configuration-api/target/test-classes:./modules/tracing/mule-tracer-exporter-configuration-impl/target/classes:./modules/tracing/mule-tracer-exporter-configuration-impl/target/test-classes:./modules/tracing/mule-tracer-exporter-configuration-impl/target/dependency/*:./modules/tracing/mule-tracer-exporter-impl/target/classes:./modules/tracing/mule-tracer-exporter-impl/target/test-classes:./modules/tracing/mule-tracer-exporter-impl/target/dependency/*:./modules/tracing/mule-tracer-internal-impl/target/classes:./modules/tracing/mule-tracer-internal-impl/target/test-classes:./modules/tracing/mule-tracer-internal-impl/target/dependency/*:./modules/troubleshooting/target/classes:./modules/troubleshooting/target/test-classes:./modules/troubleshooting/target/dependency/*:./runtime-extension-model/target/classes:./runtime-extension-model/target/test-classes:./runtime-extension-model/target/dependency/*:./tests/activemq-broker/target/dependency/*:./tests/activemq-broker/target/classes:./tests/activemq-broker/target/test-classes:./tests/allure/target/classes:./tests/allure/target/dependency/*:./tests/allure/target/test-classes:./tests/component-plugin/target/classes:./tests/component-plugin/target/test-classes:./tests/component-plugin/target/dependency/*:./tests/core-functional-tests/target/test-classes:./tests/core-functional-tests/target/dependency/*:./tests/core-functional-tests/target/classes:./tests/derby-all/target/dependency/*:./tests/derby-all/target/classes:./tests/derby-all/target/test-classes:./tests/functional/target/classes:./tests/functional/target/test-classes:./tests/functional/target/dependency/*:./tests/http-resource-service/target/classes:./tests/http-resource-service/target/dependency/*:./tests/http-resource-service/target/test-classes:./tests/infrastructure/target/classes:./tests/infrastructure/target/test-classes:./tests/infrastructure/target/dependency/*:./tests/model/target/classes:./tests/model/target/dependency/*:./tests/model/target/test-classes:./tests/performance/target/classes:./tests/performance/target/test-classes:./tests/performance/target/dependency/*:./tests/runner/target/classes:./tests/runner/target/test-classes:./tests/runner/target/dependency/*:./tests/test-extensions/classloading-extension-sdk-api/target/classes:./tests/test-extensions/classloading-extension-sdk-api/target/dependency/*:./tests/test-extensions/classloading-extension-sdk-api/target/test-classes:./tests/test-extensions/classloading-extension/target/classes:./tests/test-extensions/classloading-extension/target/dependency/*:./tests/test-extensions/classloading-extension/target/test-classes:./tests/test-extensions/custom-object-store-extension/target/classes:./tests/test-extensions/custom-object-store-extension/target/dependency/*:./tests/test-extensions/custom-object-store-extension/target/test-classes:./tests/test-extensions/heisenberg-extension/target/classes:./tests/test-extensions/heisenberg-extension/target/dependency/*:./tests/test-extensions/heisenberg-extension/target/test-classes:./tests/test-extensions/implicit-config-extension/target/classes:./tests/test-extensions/implicit-config-extension/target/dependency/*:./tests/test-extensions/implicit-config-extension/target/test-classes:./tests/test-extensions/implicit-exclusive-config-extension/target/classes:./tests/test-extensions/implicit-exclusive-config-extension/target/dependency/*:./tests/test-extensions/implicit-exclusive-config-extension/target/test-classes:./tests/test-extensions/marvel-extension/target/classes:./tests/test-extensions/marvel-extension/target/dependency/*:./tests/test-extensions/marvel-extension/target/test-classes:./tests/test-extensions/metadata-extension/target/classes:./tests/test-extensions/metadata-extension/target/dependency/*:./tests/test-extensions/metadata-extension/target/test-classes:./tests/test-extensions/mule-soap-extension/target/classes:./tests/test-extensions/mule-soap-extension/target/dependency/*:./tests/test-extensions/mule-soap-extension/target/test-classes:./tests/test-extensions/multi-implicit-config-extension/target/classes:./tests/test-extensions/multi-implicit-config-extension/target/dependency/*:./tests/test-extensions/multi-implicit-config-extension/target/test-classes:./tests/test-extensions/non-implicit-config-extension/target/classes:./tests/test-extensions/non-implicit-config-extension/target/dependency/*:./tests/test-extensions/non-implicit-config-extension/target/test-classes:./tests/test-extensions/parameter-resolver-extension/target/classes:./tests/test-extensions/parameter-resolver-extension/target/dependency/*:./tests/test-extensions/parameter-resolver-extension/target/test-classes:./tests/test-extensions/petstore-extension/target/classes:./tests/test-extensions/petstore-extension/target/dependency/*:./tests/test-extensions/petstore-extension/target/test-classes:./tests/test-extensions/provided-dependency/target/classes:./tests/test-extensions/provided-dependency/target/dependency/*:./tests/test-extensions/provided-dependency/target/test-classes:./tests/test-extensions/reconnection-ext/target/classes:./tests/test-extensions/reconnection-ext/target/dependency/*:./tests/test-extensions/reconnection-ext/target/test-classes:./tests/test-extensions/resource-extension/target/classes:./tests/test-extensions/resource-extension/target/dependency/*:./tests/test-extensions/resource-extension/target/test-classes:./tests/test-extensions/reusable-app/target/classes:./tests/test-extensions/reusable-app/target/test-classes:./tests/test-extensions/reusable-app/target/dependency/*:./tests/test-extensions/rick-and-morty-extension/target/classes:./tests/test-extensions/rick-and-morty-extension/target/dependency/*:./tests/test-extensions/rick-and-morty-extension/target/test-classes:./tests/test-extensions/sample-data-extension/target/classes:./tests/test-extensions/sample-data-extension/target/dependency/*:./tests/test-extensions/sample-data-extension/target/test-classes:./tests/test-extensions/semantic-terms-extension/target/classes:./tests/test-extensions/semantic-terms-extension/target/dependency/*:./tests/test-extensions/semantic-terms-extension/target/test-classes:./tests/test-extensions/some-extension/target/classes:./tests/test-extensions/some-extension/target/dependency/*:./tests/test-extensions/some-extension/target/test-classes:./tests/test-extensions/substitution-group-extension/target/classes:./tests/test-extensions/substitution-group-extension/target/dependency/*:./tests/test-extensions/substitution-group-extension/target/test-classes:./tests/test-extensions/subtypes-extension/target/classes:./tests/test-extensions/subtypes-extension/target/dependency/*:./tests/test-extensions/subtypes-extension/target/test-classes:./tests/test-extensions/test-config-properties-extension-deprecated-complex/target/classes:./tests/test-extensions/test-config-properties-extension-deprecated-complex/target/dependency/*:./tests/test-extensions/test-config-properties-extension-deprecated-complex/target/test-classes:./tests/test-extensions/test-config-properties-extension-deprecated/target/classes:./tests/test-extensions/test-config-properties-extension-deprecated/target/dependency/*:./tests/test-extensions/test-config-properties-extension-deprecated/target/test-classes:./tests/test-extensions/test-config-properties-extension/target/classes:./tests/test-extensions/test-config-properties-extension/target/dependency/*:./tests/test-extensions/test-config-properties-extension/target/test-classes:./tests/test-extensions/test-crafted-extension/target/classes:./tests/test-extensions/test-crafted-extension/target/dependency/*:./tests/test-extensions/test-crafted-extension/target/test-classes:./tests/test-extensions/test-localisation-properties-extension/target/classes:./tests/test-extensions/test-localisation-properties-extension/target/dependency/*:./tests/test-extensions/test-localisation-properties-extension/target/test-classes:./tests/test-extensions/test-oauth-extension/target/classes:./tests/test-extensions/test-oauth-extension/target/dependency/*:./tests/test-extensions/test-oauth-extension/target/test-classes:./tests/test-extensions/transactional-extension/target/classes:./tests/test-extensions/transactional-extension/target/dependency/*:./tests/test-extensions/transactional-extension/target/test-classes:./tests/test-extensions/typed-value-extension/target/classes:./tests/test-extensions/typed-value-extension/target/dependency/*:./tests/test-extensions/typed-value-extension/target/test-classes:./tests/test-extensions/values-extension/target/classes:./tests/test-extensions/values-extension/target/dependency/*:./tests/test-extensions/values-extension/target/test-classes:./tests/test-extensions/vegan-extension/target/classes:./tests/test-extensions/vegan-extension/target/dependency/*:./tests/test-extensions/vegan-extension/target/test-classes:./tests/test-extensions/weave-function-extension/target/classes:./tests/test-extensions/weave-function-extension/target/dependency/*:./tests/test-extensions/weave-function-extension/target/test-classes:./tests/test-extensions/target/dependency/*:./tests/test-plugins/dependant-plugin/target/classes:./tests/test-plugins/dependant-plugin/target/dependency/*:./tests/test-plugins/dependant-plugin/target/test-classes:./tests/test-plugins/empty-plugin/target/classes:./tests/test-plugins/empty-plugin/target/dependency/*:./tests/test-plugins/empty-plugin/target/test-classes:./tests/test-plugins/target/dependency/*:./tests/test-policies/target/classes:./tests/test-policies/target/test-classes:./tests/test-policies/target/dependency/*:./tests/test-processor-chains/target/classes:./tests/test-processor-chains/target/dependency/*:./tests/test-processor-chains/target/test-classes:./tests/test-runtime-extension-model/target/classes:./tests/test-runtime-extension-model/target/dependency/*:./tests/test-runtime-extension-model/target/test-classes:./tests/test-services/target/classes:./tests/test-services/target/dependency/*:./tests/test-services/target/test-classes:./tests/unit/target/classes:./tests/unit/target/test-classes:./tests/unit/target/dependency/*:./tests/target/dependency/*:/ssddata1/cxubl/software/junit/junit-4.13.2.jar:/ssddata1/cxubl/software/junit/junit-jupiter-api-5.8.2.jar:/ssddata1/cxubl/software/junit/hamcrest-core-1.3.jar:/ssddata1/cxubl/.m2/repository/org/slf4j/slf4j-api/2.0.0/slf4j-api-2.0.0.jar:/ssddata1/cxubl/.m2/repository/org/apache/logging/log4j/log4j-api/2.1/log4j-api-2.1.jar:/ssddata1/cxubl/.m2/repository/com/google/guava/guava/33.0.0-jre/guava-33.0.0-jre.jar:/ssddata1/cxubl/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.4.0/jackson-databind-2.4.0.jar:/ssddata1/cxubl/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.1/jackson-core-2.12.1.jar:/ssddata1/cxubl/.m2/repository/org/springframework/spring-test/5.3.26/spring-test-5.3.26.jar:/ssddata1/cxubl/data/ITrans/projects/thingsboard__castle__thingsboard/dao/target/dependency/commons-logging-1.2.jar:/ssddata1/cxubl/.m2/repository/org/springframework/spring-core/5.3.2/spring-core-5.3.26.jar:arex-instrumentation-api/target/dependency/jackson-annotations-2.13.1.jar:arex-instrumentation-api/target/dependency/gson-2.10.1.jar:misc/extra/target/dependency/vecmath-1.5.2.jar:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/processed_GT_only/:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/processed_MTCITrans_only/:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/generated_ITrans/:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/generated_inputs/:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/generated_inputs/:/ssddata1/cxubl/data/ITrans/projects/mulesoft__castle__mule/ITrans/generated_inputs/LLMI_test_Trans/ org.junit.runner.JUnitCore org.mule.runtime.module.log4j.internal.ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5_valid > /ssddata1/cxubl/data/ITrans/cache/generateTrans/gpt-35-turbo_T5-1_Shot0_Temprature0.2_0/exe_result/LLMI_test_Trans/org.mule.runtime.module.log4j.internal.ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5_valid.log 2>&1
file path: 
/ssddata1/cxubl/data/ITrans/cache/generateInputs/CodeQwen1.5-7B-Chat_Ti5-1_Temprature0.2_0/generated_valid_inputs_testing_Trans/ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5_valid.java
file content: 
/*
 * Copyright 2023 Salesforce, Inc. All rights reserved.
 * The software in this package is published under the terms of the CPAL v1.0
 * license, a copy of which has been included with this distribution in the
 * LICENSE.txt file.
 */
package org.mule.runtime.module.log4j.internal;

import org.mule.runtime.module.log4j.internal.ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader;

import org.mule.runtime.module.log4j.internal.ArtifactAwareContextSelector;
import org.mule.runtime.module.log4j.internal.ArtifactAwareContextSelector.*;
import static org.mule.runtime.api.util.MuleSystemProperties.MULE_LOG_CONTEXT_DISPOSE_DELAY_MILLIS;
import static org.mule.runtime.core.internal.util.MuleContainerUtils.getMuleHome;
import static org.mule.runtime.module.log4j.internal.LoggerContextReaperThreadFactory.THREAD_NAME;
import static org.mule.runtime.module.log4j.internal.MuleLoggerContextFactory.LOG4J_CONFIGURATION_FILE_PROPERTY;
import static org.mule.tck.MuleTestUtils.getRunningThreadByName;
import static org.apache.commons.lang3.StringUtils.EMPTY;
import static org.hamcrest.CoreMatchers.equalTo;
import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.CoreMatchers.notNullValue;
import static org.hamcrest.CoreMatchers.sameInstance;
import static org.hamcrest.core.IsInstanceOf.instanceOf;
import static org.hamcrest.core.IsNot.not;
import static org.junit.Assert.assertThat;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.RETURNS_MOCKS;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;
import org.mule.runtime.api.util.Reference;
import org.mule.runtime.deployment.model.api.application.ApplicationDescriptor;
import org.mule.runtime.deployment.model.api.policy.PolicyTemplateDescriptor;
import org.mule.runtime.module.artifact.api.classloader.ArtifactClassLoader;
import org.mule.runtime.module.artifact.api.classloader.ClassLoaderLookupPolicy;
import org.mule.runtime.module.artifact.api.classloader.MuleArtifactClassLoader;
import org.mule.runtime.module.artifact.api.classloader.RegionClassLoader;
import org.mule.runtime.module.artifact.api.classloader.ShutdownListener;
import org.mule.runtime.module.artifact.api.descriptor.DeployableArtifactDescriptor;
import org.mule.tck.junit4.AbstractMuleTestCase;
import org.mule.tck.junit4.rule.SystemProperty;
import org.mule.tck.probe.JUnitProbe;
import org.mule.tck.probe.PollingProber;
import org.mule.tck.probe.Probe;
import org.mule.tck.size.SmallTest;
import java.io.File;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.List;
import java.util.Arrays;
import org.apache.logging.log4j.core.LifeCycle;
import org.apache.logging.log4j.core.LoggerContext;
import org.junit.After;
import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.mockito.Answers;
import org.mockito.ArgumentCaptor;
import org.mockito.Mock;
import org.mockito.junit.MockitoJUnit;
import org.mockito.junit.MockitoRule;

@SmallTest
public class ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5_valid extends AbstractMuleTestCase {

    private static final String POLICY_TEMPLATE_NAME = policyTemplate;

    private static final String POLICY_TEMPLATE_ARTIFACT_ID = domain/app/anApp/policy/aPolicy;

    private static final File CONFIG_LOCATION = new File(src/test/resources/log4j2-test-custom.xml);

    private static final int PROBER_TIMEOUT = 5000;

    private static final int PROBER_FREQ = 500;

    @Rule
    public MockitoRule rule = MockitoJUnit.rule().silent();

    @Rule
    public SystemProperty disposeDelay = new SystemProperty(MULE_LOG_CONTEXT_DISPOSE_DELAY_MILLIS, 200);

    @Rule
    public SystemProperty log4jConfigurationFile = new SystemProperty(log4j.configurationFile, null);

    private ArtifactAwareContextSelector selector;

    @Mock(answer = Answers.RETURNS_DEEP_STUBS)
    private RegionClassLoader regionClassLoader;

    @Mock
    private DeployableArtifactDescriptor deployableArtifactDescriptor;

    @Before
    public void before() throws Exception {
        selector = new ArtifactAwareContextSelector();
        when(regionClassLoader.getArtifactId()).thenReturn(getClass().getName());
        when(regionClassLoader.findLocalResource(log4j2.xml)).thenReturn(CONFIG_LOCATION.toURI().toURL());
        when(regionClassLoader.findLocalResource(log4j2-test.xml)).thenReturn(CONFIG_LOCATION.toURI().toURL());
        when(regionClassLoader.getArtifactDescriptor()).thenReturn(deployableArtifactDescriptor);
    }

    @Test
    public void returnsMuleLoggerContextForInternalArtifactClassLoader_h0Test5() {
    String fqcn = ;
    boolean currentContext = false;
    ClassLoader systemLoader = this.getClass().getClassLoader();
		List<Object> transformed_inputs = ArtifactAwareContextSelectorTestCase_returnsMuleLoggerContextForInternalArtifactClassLoader.inputTransformation_returnsMuleLoggerContextForInternalArtifactClassLoader(fqcn, currentContext, systemLoader);
    String fqcn2  = (String) transformed_inputs.get(0);
    boolean currentContext2  = (boolean) transformed_inputs.get(2);
    ArtifactClassLoader serviceClassLoader = new MuleArtifactClassLoader(test, new ApplicationDescriptor(test), new URL[0], systemLoader, mock(ClassLoaderLookupPolicy.class));
    ClassLoader serviceLoader  = (ClassLoader) transformed_inputs.get(1);
        LoggerContext systemContext = selector.getContext(fqcn, systemLoader, currentContext);
        LoggerContext serviceCtx = selector.getContext(fqcn2, serviceLoader, currentContext2);
        assertThat(serviceCtx, sameInstance(systemContext));
    }

    // @After
    // public void after() throws Exception {
    // dispose();
    // }
    private void assertReaperThreadNotRunning() {
        PollingProber prober = new PollingProber(PROBER_TIMEOUT, PROBER_FREQ);
        prober.check(new Probe() {

            @Override
            public boolean isSatisfied() {
                return getReaperThread() == null;
            }

            @Override
            public String describeFailure() {
                return Reaper thread exists from previous test and did not died;
            }
        });
    }

    private Thread getReaperThread() {
        return getRunningThreadByName(THREAD_NAME);
    }

    private MuleLoggerContext getContext() {
        return (MuleLoggerContext) selector.getContext(, regionClassLoader, true);
    }

    private void assertConfigurationLocation(LoggerContext ctx) {
        assertThat(ctx.getConfigLocation(), equalTo(CONFIG_LOCATION.toURI()));
    }

    private RegionClassLoader getPolicyRegionClassLoader(PolicyTemplateDescriptor policyTemplateDescriptor) {
        return new RegionClassLoader(POLICY_TEMPLATE_ARTIFACT_ID, policyTemplateDescriptor, regionClassLoader, mock(ClassLoaderLookupPolicy.class));
    }

    private MuleArtifactClassLoader getPolicyArtifactClassLoader(PolicyTemplateDescriptor policyTemplateDescriptor, RegionClassLoader policyRegionClassLoader) {
        return new MuleArtifactClassLoader(POLICY_TEMPLATE_ARTIFACT_ID, policyTemplateDescriptor, new URL[0], policyRegionClassLoader, mock(ClassLoaderLookupPolicy.class));
    }

    private void assertStopped(final MuleLoggerContext context) {
        final Reference<Boolean> contextWasAccessibleDuringShutdown = new Reference<>(true);
        PollingProber pollingProber = new PollingProber(1000, 10);
        pollingProber.check(new JUnitProbe() {

            @Override
            protected boolean test() throws Exception {
                if (context.getState().equals(LifeCycle.State.STOPPED)) {
                    assertThat(context, not(getContext()));
                    return true;
                } else {
                    LoggerContext currentContext = getContext();
                    if (currentContext != null && currentContext != context) {
                        contextWasAccessibleDuringShutdown.set(false);
                    }
                    return false;
                }
            }

            @Override
            public String describeFailure() {
                return context was not stopped;
            }
        });
        assertThat(contextWasAccessibleDuringShutdown.get(), is(true));
    }
}


